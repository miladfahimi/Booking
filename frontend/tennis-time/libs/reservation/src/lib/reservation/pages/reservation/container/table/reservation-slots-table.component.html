<div
  class="reservation-slots-table flex flex-col gap-4 rounded-2xl bg-white p-4 shadow-[0_10px_30px_rgba(15,23,42,0.08)]">
  <div class="table-container overflow-x-auto" role="region" aria-live="polite" tabindex="0">
    <table class="w-full table-fixed border-collapse">
      <thead>
        <tr>
          <th
            class="time-header w-20 rounded-tl-2xl border-b border-slate-200 bg-slate-50 px-3 py-3 text-center text-sm font-semibold text-slate-900">
            ساعت
          </th>
          @for (service of services; track service.id) {
          <th
            class="service-header border-b border-slate-200 bg-slate-50 px-0 text-center text-sm font-semibold text-slate-900"
            [class.is-selected]="service.id === selectedServiceId" scope="col">
            <button type="button"
              class="service-header__button flex w-full items-center justify-center rounded-xl px-3 py-3 text-sm font-medium text-slate-900 transition-colors duration-200 ease-in-out"
              (click)="onServiceHeaderClick(service)" [attr.aria-pressed]="service.id === selectedServiceId">
              {{ service.name }}
            </button>
          </th>
          }
        </tr>
      </thead>
      <tbody>
        @for (hour of displayedHours; track hour; let isEven = $even) {
        <tr>
          <th scope="row"
            class="time-cell sticky left-0 z-[1] border-r border-slate-200 px-3 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"
            [class.bg-slate-100]="isEven" [class.bg-slate-50]="!isEven">
            {{ hour }}
          </th>
          @for (service of services; track service.id) {
          <td class="px-2 py-2 text-center align-middle">
            @if (getSlotFor(service.id, hour); as slot) {
            <button type="button"
              class="slot-cell flex h-11 w-full items-center justify-center rounded-xl border border-transparent bg-slate-200 text-sm font-medium text-slate-700 transition-all duration-150 ease-in-out hover:-translate-y-0.5 hover:shadow-[0_6px_12px_rgba(14,165,233,0.2)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 disabled:cursor-not-allowed disabled:opacity-70 md:h-12"
              [ngClass]="getStatusClass(slot)" [class.selected]="isSelected(service.id, slot.slotId)"
              [disabled]="isSlotDisabled(slot)" (click)="onSlotClick(service, slot)"
              [attr.aria-label]="getCellAriaLabel(service.name, slot)"
              [attr.title]="getCellAriaLabel(service.name, slot)">
            </button>
            } @else {
            <div
              class="slot-cell empty flex h-11 w-full items-center justify-center rounded-xl border border-dashed border-indigo-200 bg-transparent text-sm font-medium text-slate-400 md:h-12"
              [attr.title]="getCellAriaLabel(service.name, null)">
            </div>
            }
          </td>
          }
        </tr>
        }
      </tbody>
    </table>
  </div>
  <div class="legend flex items-center justify-end gap-4 text-xs text-slate-500" aria-hidden="true">
    <div class="legend-item available inline-flex items-center gap-2">
      <span class="h-3.5 w-3.5 rounded"></span>
      در دسترس
    </div>
    <div class="legend-item booked inline-flex items-center gap-2">
      <span class="h-3.5 w-3.5 rounded"></span>
      رزرو شده
    </div>
    <div class="legend-item pending inline-flex items-center gap-2">
      <span class="h-3.5 w-3.5 rounded"></span>
      در انتظار
    </div>
  </div>
</div>