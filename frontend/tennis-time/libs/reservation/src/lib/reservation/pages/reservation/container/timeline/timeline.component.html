<!-- timeline.component.html -->
<div class="timeline" role="presentation" [style.--pixels-per-minute.px]="pixelsPerMinute">
  <div class="timeline__viewport">
    <div class="timeline__grid" [style.height.px]="timelineHeight">

      <div class="timeline__hours">
        <div class="timeline__guides" aria-hidden="true"></div>

        <div class="timeline__hour" *ngFor="let hour of hourLabels; trackBy: trackHourByValue"
          [style.height.px]="hourHeight">
          <span class="timeline__hour-label">{{ hour | faDigits }}</span>
        </div>
      </div>

      <div class="timeline__columns">
        <div class="timeline__guides" aria-hidden="true"></div>

        <div class="timeline__column" *ngFor="let column of columns; trackBy: trackColumnById">
          <div class="timeline__column-header">{{ column.label }}</div>

          <div class="timeline__column-body" [style.height.px]="timelineHeight">
            <div class="timeline-slot" *ngFor="let slot of column.slots; trackBy: trackSlotById"
              (click)="onSlotClick(slot, column)"
              [class.timeline-slot--booked]="slot.status === ReservationStatusEnum.CONFIRMED && !isMyBookedSlot(slot)"
              [class.timeline-slot--available]="slot.status === ReservationStatusEnum.AVAILABLE || (slot.status === ReservationStatusEnum.IN_BASKET && !isMyBasketSlot(slot))"
              [class.timeline-slot--pending]="slot.status === ReservationStatusEnum.PENDING"
              [class.timeline-slot--basket]="isMyBasketSlot(slot)"
              [class.timeline-slot--maintenance]="slot.status === ReservationStatusEnum.MAINTENANCE"
              [class.timeline-slot--mine]="isMyBookedSlot(slot)" [style.top.px]="getSlotOffset(slot)"
              [style.height.px]="getSlotHeight(slot)">
              <span class="timeline-slot__label">
                {{ getSlotLabel(slot) | faDigits }}
              </span>
              <span class="timeline-slot__time">{{ slot.start | faDigits }} ~ {{ slot.end | faDigits }}</span>
              <span class="timeline-slot__time">{{ slot.durationMinutes | faDigits }} دقیقه</span>
              <span class="timeline-slot__hold-indicator"
                *ngIf="slot.status === ReservationStatusEnum.IN_BASKET && !isMyBasketSlot(slot)">
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <circle cx="12" cy="12" r="8.5" fill="none" stroke-width="2" stroke="currentColor" />
                  <path d="M12 7v5l3 2" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    stroke="currentColor" />
                  <path d="M15 4 16.5 5.5" fill="none" stroke-width="2" stroke-linecap="round" stroke="currentColor" />
                </svg>
              </span>
            </div>
          </div>

        </div>
      </div>

    </div>

  </div>
  <div class="timeline__legend" aria-hidden="true" role="note">
    <div class="legend">
      <div class="legend-item mine">
        <span></span> من
      </div>
      <div class="legend-item available">
        <span></span>
        در دسترس
      </div>
      <div class="legend-item booked">
        <span></span>
        رزرو شده
      </div>
      <div class=" legend-item pending">
        <span></span>
        در انتظار پرداخت
      </div>
      <div class="legend-item maintenance">
        <span></span>
        در حال تعمیر
      </div>
    </div>
  </div>
</div>

<app-timeline-slot-modal *ngIf="selectedSlotDetails as slotDetails" [slot]="slotDetails" (close)="onModalClose()"
  (addToBasket)="onAddToBasket($event)"></app-timeline-slot-modal>