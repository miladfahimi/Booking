<div class="timeline" role="presentation" [style.--pixels-per-minute.px]="pixelsPerMinute">
  <div class="timeline__viewport">
    <div class="timeline__grid" [style.height.px]="timelineHeight">

      <div class="timeline__hours">
        <div class="timeline__guides" aria-hidden="true"></div>

        @for (hour of hourLabels; track hour) {
        <div class="timeline__hour" [style.height.px]="hourHeight">
          <span class="timeline__hour-label">{{ hour | faDigits }}</span>
        </div>
        }
      </div>

      <div class="timeline__columns">
        <div class="timeline__guides" aria-hidden="true"></div>

        @for (column of columns; track column.id) {
        <div class="timeline__column">
          <div class="timeline__column-header">{{ column.label }}</div>

          <div class="timeline__column-body" [style.height.px]="timelineHeight">
            @for (slot of column.slots; track slot.id ) {
            <div class="timeline-slot" (click)="onSlotClick(slot, column)" [style.top.px]="getSlotOffset(slot)"
              [style.height.px]="getSlotHeight(slot)">
              @if (isMyBookedSlot(slot)) {
              <app-timeline-slot-booked-mine [height]="getSlotHeight(slot)" [label]="getSlotLabel(slot)"
                [start]="slot.start" [end]="slot.end"
                [durationMinutes]="slot.durationMinutes"></app-timeline-slot-booked-mine>
              } @else if (isMyBasketSlot(slot)) {
              <app-timeline-slot-basket-mine [height]="getSlotHeight(slot)" [label]="getSlotLabel(slot)"
                [start]="slot.start" [end]="slot.end" [durationMinutes]="slot.durationMinutes"
                [showHoldIndicator]="hasForeignBasketHold(slot)">
              </app-timeline-slot-basket-mine>
              } @else if (slot.status === ReservationStatusEnum.CONFIRMED) {
              <app-timeline-slot-booked [height]="getSlotHeight(slot)" [label]="getSlotLabel(slot)" [start]="slot.start"
                [end]="slot.end" [durationMinutes]="slot.durationMinutes"></app-timeline-slot-booked>
              } @else if (slot.status === ReservationStatusEnum.PENDING) {
              <app-timeline-slot-pending [height]="getSlotHeight(slot)" [label]="getSlotLabel(slot)"
                [start]="slot.start" [end]="slot.end"
                [durationMinutes]="slot.durationMinutes"></app-timeline-slot-pending>
              } @else if (slot.status === ReservationStatusEnum.MAINTENANCE) {
              <app-timeline-slot-maintenance [height]="getSlotHeight(slot)" [label]="getSlotLabel(slot)"
                [start]="slot.start" [end]="slot.end"
                [durationMinutes]="slot.durationMinutes"></app-timeline-slot-maintenance>
              } @else if (slot.status === ReservationStatusEnum.IN_BASKET) {
              <app-timeline-slot-basket [height]="getSlotHeight(slot)" [label]="getSlotLabel(slot)" [start]="slot.start"
                [end]="slot.end" [durationMinutes]="slot.durationMinutes"
                [showHoldIndicator]="hasForeignBasketHold(slot)">
              </app-timeline-slot-basket>
              } @else {
              <app-timeline-slot-available [height]="getSlotHeight(slot)" [label]="getSlotLabel(slot)"
                [start]="slot.start" [end]="slot.end"
                [durationMinutes]="slot.durationMinutes"></app-timeline-slot-available>
              }
            </div>
            }
          </div>
        </div>
        }
      </div>

    </div>
  </div>

  @if (selectedSlotDetails; as slotDetails) {
  <app-timeline-slot-modals [slot]="slotDetails" (close)="onModalClose()" (addToBasket)="onAddToBasket($event)">
  </app-timeline-slot-modals>
  }